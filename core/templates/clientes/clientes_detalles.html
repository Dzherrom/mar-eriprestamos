{% extends "layouts/base.html" %}
{% load static %}
{% block content %}
<div class="container">
    <div class="main-container">
        <!-- Tarjeta de Información General -->
        <div class="card-general">
            <h5>Información General</h5>
            <div class="card-general-info"> 
                <div>
                    <p>Nombre y Apellido: {{ cliente.nombre }} {{ cliente.apellido }}</p>
                    <p>Cedula: {{ cliente.cedula }}</p>
                </div>
                <div>
                    <p>Prestamos Activos: {{ prestamos_activos }}</p>
                    <p>Prestamos Pagados: {{ prestamos_pagados }}</p>
                </div>
                <div>
                    <p>Balance General: {{ balance }}</p>
                    <p>Balance Prestado: {{ balance_total }}</p>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Tarjeta de Transacciones -->
            <div class="card-transacciones col">
                <h5>Transacciones</h5>
                <table>
                    <thead>
                        <tr>
                            <th>Fecha de Pago</th>
                            <th>Moneda</th>
                            <th>Tipo de Pago</th>
                            <th>Referencia</th>
                            <th>Monto</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for pago in pagos %}
                        <tr>
                            <td>{{ pago.fecha_pago }}</td>
                            <td>{{ pago.moneda }}</td>
                            <td>{{ pago.tipo_pago }}</td>
                            <td>{{ pago.referencia }}</td>
                            <td>${{ pago.monto }}</td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="5" class="text-center">No hay pagos registrados.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <!-- Tarjeta de Total Pagado -->
            <div class="card-total-pagado col">
                <h5>Total Pagado</h5>
                <p>Seleccione un cliente:</p>
                <select id="cliente-select">
                    <!-- Aquí se llenará con los clientes disponibles -->
                    
                        <option value="{{ cliente.id }}">{{ cliente.nombre }}</option>
                    
                </select>
                <div id="grafico-total-pagado">
                    <!-- Aquí se mostrará el gráfico en círculo -->
                </div>
            </div>

            <!-- Tarjeta de Pagos Totales -->
            <div class="card-pagos-totales col">
                <h5>Pagos Totales</h5>
                <div id="grafico-pagos-totales">
                    <!-- Aquí se mostrará el gráfico en círculo con el monto total de todos los préstamos activos -->
                </div>
            </div>
        </div>
        <div class="container">
            <div class="detalles-container">
                <div class="left-column">
                    <div class="card-left">
                        <h5>Información Básica</h5>
                        <p>Tipo de persona: {{ cliente.tipo_persona }}</p>
                        <p>Nombre: {{ cliente.nombre }}</p>
                        <p>Apellido: {{ cliente.apellido }}</p>
                        <p>Genero: {{ cliente.nombre }}</p>
                        <p>Fecha de Nacimiento: {{ cliente.fecha_nacimiento }}</p>
                    </div>
                    <div class="card-left">
                        <h5>Información Adicional</h5>
                        <p>Modificado Por: </p>
                        <p>Ultimo pago:  {{ fecha_ultimo_pago }} </p>
                        <p>Prestamos activos: {{ prestamos_activos }} </p>
                        <p>Prestamos pagados: {{ prestamos_pagados }} </p>
                    </div>
                </div>
                <div class="right-column">
                    <div class="card-right">
                        <h5>Direcciones</h5>
                        <p>Direccion 1: {{ cliente.direccion_1 }}</p>
                        <p>Direccion 2: {{ cliente.direccion_2 }}</p>
        
                    </div>
                    <div class="card-right">
                        <h5>Documento de Identidad</h5>
                        <p>Cedula de identidad: {{ cliente.cedula }}</p>
                        <p>RIF: {{ cliente.rif }}</p>
                    </div>
                    <div class="card-right">
                        <h5>Información de Contacto</h5>
                        <p>Correo 1: {{ cliente.email_1 }}</p>
                        <p>Correo 2: {{ cliente.email_2 }}</p>
                        <p>Numero de telefono: {{ cliente.numero_telefono }}</p>
                        <p>Numero local: {{ cliente.numero_local }}</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="table-container">
            <div class="clientes">
                <h2>Clientes</h2>
                <div style="display: grid; grid-template-columns: 1fr auto; margin-bottom: 10px;">
                    <div></div>
                <input type="text" id="searchInputPagados" placeholder="Buscar por cliente..." class="form-control" style="margin-bottom: 10px; max-width: 100%; ">
                </div>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th class="th sort-both">ID</th>
                            <th class="th sort-both">Nombre</th>
                            <th class="th sort-both">Apellido</th>
                            <th class="th sort-both">Cedula</th>
                            <th class="th sort-both">Prestamos activos</th>
                            <th class="th sort-both">Prestamos pagados</th>
                            <th class="th sort-both">Balance</th>
                        </tr>
                    </thead>
                    <tbody id="pagadosTableBody">
                        {% for clientes in clientes %}
                        <tr>
                            <td>{{ cliente.id }}</td>
                            <td>{{ cliente.nombre }} {{ cliente.apellido }}</td>
                            <td>{{ cliente.cedula }}</td>
                            <td>{{ cliente.prestamos_activos }}</td>
                            <td>{{ cliente.prestamos_pagados }}</td>
                            <td>${{ cliente.balance }}</td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="7" class="text-center">No hay clientes registrados.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
    </div>
</div>
{% endblock content %}